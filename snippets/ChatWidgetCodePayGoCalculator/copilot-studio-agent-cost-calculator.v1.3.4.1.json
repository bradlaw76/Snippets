{
  "name": "Copilot Studio Agent Cost Calculator",
  "version": "1.3.4.1",
  "description": "",
  "category": "PayGoCalculator",
  "language": "html",
  "status": "working",
  "tags": [],
  "timestamp": "2026-02-06T16:38:41.346Z",
  "code": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Copilot Studio Agent Cost Calculator v1.3.4.1</title>\n    <!-- \n        APPLICATION: Copilot Studio Agent Cost Calculator\n        VERSION: 1.3.4.1\n        UPDATES:\n            - Fixed TypeError: \"Cannot set properties of null\" by restoring missing DOM elements.\n            - Added null-checks to calculate() to prevent script crashes if UI elements are missing.\n            - Restored \"Daily Total Credits\" to the results dashboard.\n            - Maintained PDF report and Outlook integration features.\n    -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js\"></script>\n    <style>\n        body { font-family: system-ui, -apple-system, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif; }\n        .card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); }\n        .bg-gradient { background: radial-gradient(circle at top right, #f0f9ff 0%, #e0f2fe 50%, #f1f5f9 100%); }\n        input[type=range] { accent-color: #0284c7; }\n        .tab-active { border-bottom: 3px solid #0284c7; color: #0f172a; font-weight: 600; }\n        .modal-overlay { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(4px); }\n        .enter-here { color: #0284c7; font-weight: 700; font-size: 0.70rem; animation: pulse 2s infinite; white-space: nowrap; }\n        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }\n        ::-webkit-scrollbar { width: 6px; }\n        ::-webkit-scrollbar-track { background: transparent; }\n        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }\n        .mode-toggle { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }\n        .mode-active { background-color: #0284c7; color: white; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }\n    </style>\n</head>\n<body class=\"bg-gradient min-h-screen text-slate-800 p-4 md:p-8\">\n    <div class=\"max-w-6xl mx-auto\">\n        <!-- Header -->\n        <header class=\"relative text-center mb-8\">\n            <button onclick=\"toggleSettings(true)\" class=\"absolute right-0 top-0 p-2 text-slate-400 hover:text-sky-600 transition-colors bg-white/50 rounded-xl border border-white shadow-sm\" title=\"Settings\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-6 h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" /><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                </svg>\n            </button>\n            <div class=\"inline-flex items-center justify-center p-3 bg-sky-100 rounded-2xl mb-4 shadow-sm\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-8 h-8 text-sky-600\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 10V3L4 14h7v7l9-11h-7z\" /></svg>\n            </div>\n            <h1 class=\"text-3xl font-bold tracking-tight text-slate-900 uppercase\">Budgetary Cost Estimator</h1>\n            <p class=\"text-slate-500 mt-1 italic text-sm\">v1.3.4.1 • Enterprise Reporting Suite</p>\n            <div class=\"flex justify-center mt-6\">\n                <div class=\"bg-white/60 p-1 rounded-2xl border border-white flex shadow-sm\">\n                    <button id=\"mode-std\" onclick=\"setMode('standard')\" class=\"px-6 py-2 rounded-xl text-sm font-semibold mode-toggle mode-active\">Standard Agents</button>\n                    <button id=\"mode-auto\" onclick=\"setMode('autonomous')\" class=\"px-6 py-2 rounded-xl text-sm font-semibold mode-toggle text-slate-500\">Autonomous Agents</button>\n                </div>\n            </div>\n        </header>\n\n        <!-- Navigation Tabs -->\n        <div class=\"flex justify-center space-x-8 mb-8 border-b border-slate-200\">\n            <button onclick=\"switchTab('calculator')\" id=\"tab-calc\" class=\"pb-3 px-2 tab-active transition-all\">Calculator</button>\n            <button onclick=\"switchTab('pricing')\" id=\"tab-pricing\" class=\"pb-3 px-2 text-slate-500 hover:text-slate-700 transition-all\">Rates & Logic</button>\n        </div>\n\n        <div id=\"content-calculator\" class=\"block\">\n            <div class=\"grid grid-cols-1 lg:grid-cols-12 gap-8\">\n                <!-- Inputs Panel -->\n                <div class=\"lg:col-span-7 space-y-6\">\n                    <div class=\"card p-6 rounded-3xl shadow-xl border border-white\">\n                        <h2 class=\"text-lg font-semibold mb-6 flex items-center\">\n                            <span class=\"w-2 h-6 bg-sky-500 rounded-full mr-2\"></span>\n                            Deployment Scale\n                        </h2>\n                        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                            <div class=\"bg-orange-50/50 p-4 rounded-2xl border border-orange-100\">\n                                <div class=\"flex justify-between mb-2 items-center\">\n                                    <label class=\"text-xs font-bold uppercase tracking-wider text-slate-500\">Number of Agents</label>\n                                    <div class=\"flex items-center gap-2\">\n                                        <input type=\"number\" id=\"num_agents\" value=\"10\" oninput=\"syncInputs('agents', this.value)\" class=\"w-16 p-1 text-right font-bold text-sky-600 bg-white border border-slate-200 rounded focus:ring-2 focus:ring-sky-500 outline-none\">\n                                        <span class=\"enter-here\"><< enter here</span>\n                                    </div>\n                                </div>\n                                <input type=\"range\" id=\"agents\" min=\"0\" max=\"100\" value=\"10\" oninput=\"syncInputs('num_agents', this.value)\" class=\"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer\">\n                            </div>\n                            <div class=\"bg-orange-50/50 p-4 rounded-2xl border border-orange-100\">\n                                <div class=\"flex justify-between mb-2 items-center\">\n                                    <label class=\"text-xs font-bold uppercase tracking-wider text-slate-500\">Convos / Agent / Day</label>\n                                    <div class=\"flex items-center gap-2\">\n                                        <input type=\"number\" id=\"num_convos\" value=\"30\" oninput=\"syncInputs('convos', this.value)\" class=\"w-16 p-1 text-right font-bold text-sky-600 bg-white border border-slate-200 rounded focus:ring-2 focus:ring-sky-500 outline-none\">\n                                        <span class=\"enter-here\"><< enter here</span>\n                                    </div>\n                                </div>\n                                <input type=\"range\" id=\"convos\" min=\"0\" max=\"500\" value=\"30\" oninput=\"syncInputs('num_convos', this.value)\" class=\"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer\">\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"card p-6 rounded-3xl shadow-xl border border-white\">\n                        <h2 class=\"text-lg font-semibold mb-6 flex items-center\">\n                            <span class=\"w-2 h-6 bg-emerald-500 rounded-full mr-2\"></span>\n                            <span id=\"complexity-title\">Session Profile</span>\n                        </h2>\n                        \n                        <div id=\"standard-inputs\" class=\"space-y-8\">\n                            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8\">\n                                <div class=\"bg-blue-50/30 p-4 rounded-2xl border border-blue-100/50\">\n                                    <div class=\"flex justify-between mb-2 items-center text-[10px] uppercase font-bold text-slate-400\">\n                                        <span>Graph Grounding</span>\n                                        <input type=\"number\" id=\"num_graph\" value=\"3\" oninput=\"syncInputs('graph', this.value)\" class=\"w-12 p-1 text-right text-emerald-600 bg-white border border-slate-200 rounded\">\n                                    </div>\n                                    <input type=\"range\" id=\"graph\" min=\"0\" max=\"20\" value=\"3\" oninput=\"syncInputs('num_graph', this.value)\" class=\"w-full h-1.5 mt-2\">\n                                </div>\n                                <div class=\"bg-blue-50/30 p-4 rounded-2xl border border-blue-100/50\">\n                                    <div class=\"flex justify-between mb-2 items-center text-[10px] uppercase font-bold text-slate-400\">\n                                        <span>GenAI Answers</span>\n                                        <input type=\"number\" id=\"num_genai\" value=\"4\" oninput=\"syncInputs('genai', this.value)\" class=\"w-12 p-1 text-right text-emerald-600 bg-white border border-slate-200 rounded\">\n                                    </div>\n                                    <input type=\"range\" id=\"genai\" min=\"0\" max=\"20\" value=\"4\" oninput=\"syncInputs('num_genai', this.value)\" class=\"w-full h-1.5 mt-2\">\n                                </div>\n                            </div>\n                        </div>\n\n                        <div id=\"autonomous-inputs\" class=\"hidden space-y-8\">\n                            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                <div class=\"bg-purple-50/30 p-4 rounded-2xl border border-purple-100\">\n                                    <div class=\"flex justify-between mb-2 items-center text-[10px] uppercase font-bold text-slate-400\">\n                                        <span>Auto Triggers</span>\n                                        <input type=\"number\" id=\"num_triggers\" value=\"1\" oninput=\"syncInputs('triggers', this.value)\" class=\"w-12 p-1 text-right text-purple-600 rounded border border-slate-200\">\n                                    </div>\n                                    <input type=\"range\" id=\"triggers\" min=\"0\" max=\"10\" value=\"1\" oninput=\"syncInputs('num_triggers', this.value)\" class=\"w-full h-1.5 mt-2\">\n                                </div>\n                                <div class=\"bg-purple-50/30 p-4 rounded-2xl border border-purple-100\">\n                                    <div class=\"flex justify-between mb-2 items-center text-[10px] uppercase font-bold text-slate-400\">\n                                        <span>Reasoning steps (o1)</span>\n                                        <input type=\"number\" id=\"num_deep\" value=\"2\" oninput=\"syncInputs('deep', this.value)\" class=\"w-12 p-1 text-right text-purple-600 rounded border border-slate-200\">\n                                    </div>\n                                    <input type=\"range\" id=\"deep\" min=\"0\" max=\"10\" value=\"2\" oninput=\"syncInputs('num_deep', this.value)\" class=\"w-full h-1.5 mt-2\">\n                                </div>\n                                <div class=\"bg-purple-50/30 p-4 rounded-2xl border border-purple-100\">\n                                    <div class=\"flex justify-between mb-2 items-center text-[10px] uppercase font-bold text-slate-400\">\n                                        <span>Flow Actions</span>\n                                        <input type=\"number\" id=\"num_flow\" value=\"4\" oninput=\"syncInputs('flow_slider', this.value)\" class=\"w-12 p-1 text-right text-purple-600 rounded border border-slate-200\">\n                                    </div>\n                                    <input type=\"range\" id=\"flow_slider\" min=\"0\" max=\"20\" value=\"4\" oninput=\"syncInputs('num_flow', this.value)\" class=\"w-full h-1.5 mt-2\">\n                                </div>\n                                <div class=\"bg-purple-50/30 p-4 rounded-2xl border border-purple-100\">\n                                    <div class=\"flex justify-between mb-2 items-center text-[10px] uppercase font-bold text-slate-400\">\n                                        <span>GenAI Answers</span>\n                                        <input type=\"number\" id=\"num_auto_genai\" value=\"4\" oninput=\"syncInputs('auto_genai', this.value)\" class=\"w-12 p-1 text-right text-purple-600 rounded border border-slate-200\">\n                                    </div>\n                                    <input type=\"range\" id=\"auto_genai\" min=\"0\" max=\"20\" value=\"4\" oninput=\"syncInputs('num_auto_genai', this.value)\" class=\"w-full h-1.5 mt-2\">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Forecast Panel -->\n                <div class=\"lg:col-span-5\">\n                    <div class=\"sticky top-8 space-y-4\">\n                        <div class=\"bg-slate-900 text-white p-8 rounded-3xl shadow-2xl relative overflow-hidden\">\n                            <div class=\"relative z-10\">\n                                <p class=\"text-slate-400 text-sm font-medium uppercase tracking-wider mb-2\">Fleet Annual Investment</p>\n                                <div class=\"text-5xl font-bold mb-2\" id=\"total_annual\">$0.00</div>\n                                <p class=\"text-slate-400 text-xs mb-8\" id=\"calc_methodology\">Estimated for funding purposes (<span class=\"val-days\">22</span> days/mo)</p>\n                                <div class=\"space-y-4 pt-6 border-t border-slate-700\">\n                                    <div class=\"flex justify-between items-center text-sm\">\n                                        <span class=\"text-slate-400\">Typical Agent Monthly</span>\n                                        <span class=\"font-bold text-lg\" id=\"agent_cost_monthly\">$0.00</span>\n                                    </div>\n                                    <div class=\"flex justify-between items-center text-sm\">\n                                        <span class=\"text-slate-400\">Daily Total Credits</span>\n                                        <span class=\"font-semibold text-sky-400\" id=\"total_msgs_daily\">0</span>\n                                    </div>\n                                </div>\n                                \n                                <div class=\"grid grid-cols-1 gap-3 mt-8\">\n                                    <button onclick=\"downloadPDF()\" class=\"w-full bg-white text-slate-900 font-bold py-3 rounded-xl hover:bg-sky-50 transition-colors flex items-center justify-center gap-2 shadow-lg\">\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-5 h-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" /></svg>\n                                        Download PDF Report\n                                    </button>\n                                    <button onclick=\"generateEmail()\" class=\"w-full bg-sky-600 text-white font-bold py-3 rounded-xl hover:bg-sky-500 transition-all flex items-center justify-center gap-2 shadow-lg group\">\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-5 h-5 group-hover:scale-110\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" /></svg>\n                                        Generate Funding Draft\n                                    </button>\n                                </div>\n                            </div>\n                            <div class=\"absolute -bottom-10 -right-10 w-40 h-40 bg-sky-500/10 blur-3xl rounded-full\"></div>\n                        </div>\n                        <div class=\"bg-white/70 border border-white p-6 rounded-3xl shadow-sm\" id=\"main-breakdown\">\n                            <h3 class=\"text-sm font-bold text-slate-900 mb-4 flex items-center uppercase tracking-widest border-b border-slate-100 pb-2\">Calculation Breakdown</h3>\n                            <div id=\"breakdown-container\" class=\"space-y-3 text-xs\"></div>\n                            <div class=\"mt-6 pt-4 border-t border-slate-100 text-slate-500 text-[11px] leading-relaxed italic\" id=\"summary_text\"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Pricing Tab -->\n        <div id=\"content-pricing\" class=\"hidden space-y-8 pb-12\">\n            <div class=\"card p-8 rounded-3xl shadow-xl border border-white\">\n                <h2 class=\"text-xl font-bold mb-6 text-slate-900\">Logic Baseline (Jan 2026 Credits)</h2>\n                <div class=\"overflow-x-auto\">\n                    <table class=\"w-full text-left text-sm text-slate-600\">\n                        <thead class=\"bg-slate-50\"><tr class=\"border-b border-slate-200\">\n                            <th class=\"p-4 font-bold text-slate-900 rounded-tl-xl\">Consumption Category</th>\n                            <th class=\"p-4 font-bold text-slate-900 text-center\">Standard Credit Burn</th>\n                            <th class=\"p-4 font-bold text-slate-900 rounded-tr-xl\">Logic Source Note</th>\n                        </tr></thead>\n                        <tbody id=\"rate-table-body\"></tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n\n        <!-- Hidden PDF Container (Off-screen) -->\n        <div style=\"position: absolute; left: -9999px; top: 0;\">\n            <div id=\"pdf-content\" class=\"p-10 bg-white\" style=\"width: 800px;\">\n                <div class=\"flex justify-between items-start border-b-2 border-sky-600 pb-6 mb-8\">\n                    <div>\n                        <h1 class=\"text-3xl font-bold text-slate-900\">Copilot Studio Cost Estimate</h1>\n                        <p class=\"text-sky-600 font-semibold uppercase tracking-wider\">Budgetary Funding Report</p>\n                    </div>\n                    <div class=\"text-right text-xs text-slate-500\">\n                        <p>Date: <span id=\"pdf-date\"></span></p>\n                        <p>Version: 1.3.4.1</p>\n                    </div>\n                </div>\n\n                <div class=\"grid grid-cols-2 gap-10 mb-10\">\n                    <div class=\"bg-slate-50 p-6 rounded-xl\">\n                        <h2 class=\"text-xs font-bold text-slate-400 uppercase mb-4\">Deployment Configuration</h2>\n                        <div class=\"space-y-2 text-sm\">\n                            <div class=\"flex justify-between\"><span>Agent Mode:</span><span id=\"pdf-mode\" class=\"font-bold\"></span></div>\n                            <div class=\"flex justify-between\"><span>Total Agents:</span><span id=\"pdf-agents\" class=\"font-bold\"></span></div>\n                            <div class=\"flex justify-between\"><span>Daily Convos/Agent:</span><span id=\"pdf-convos\" class=\"font-bold\"></span></div>\n                        </div>\n                    </div>\n                    <div class=\"bg-sky-900 text-white p-6 rounded-xl\">\n                        <h2 class=\"text-xs font-bold text-sky-300 uppercase mb-4\">Financial Summary</h2>\n                        <div class=\"space-y-2\">\n                            <div class=\"flex justify-between\"><span>Estimated Annual:</span><span id=\"pdf-annual\" class=\"text-xl font-bold\"></span></div>\n                            <div class=\"flex justify-between text-sm opacity-80\"><span>Estimated Monthly:</span><span id=\"pdf-monthly\"></span></div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"mb-10\">\n                    <h2 class=\"text-xs font-bold text-slate-400 uppercase mb-4\">Calculated Daily Intensity</h2>\n                    <div id=\"pdf-breakdown\" class=\"border rounded-xl p-6 space-y-3 text-sm\"></div>\n                </div>\n\n                <div class=\"mt-20 pt-8 border-t text-[10px] text-slate-400 leading-relaxed\">\n                    <p><strong>Funding Disclaimer:</strong> This document provides estimated values for planning and budgetary funding purposes only. Actual consumption, runtime orchestration logic, and environment-specific patterns will result in differences in final billing. Projections assume a 22-business day cycle per month at current standard Microsoft Copilot Credit rates.</p>\n                </div>\n            </div>\n        </div>\n\n        <footer class=\"mt-8 text-center text-slate-400 text-[10px] pb-10 flex flex-col gap-1 items-center italic\">\n            <span>Microsoft Copilot Studio • Consumption Modeling • 22 Business Day Run-rate</span>\n        </footer>\n    </div>\n\n    <!-- Settings Modal -->\n    <div id=\"settings-modal\" class=\"fixed inset-0 z-50 hidden flex items-center justify-center p-4\">\n        <div class=\"absolute inset-0 modal-overlay\" onclick=\"toggleSettings(false)\"></div>\n        <div class=\"relative bg-white w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden\">\n            <div class=\"p-6 border-b flex justify-between items-center\"><h2 class=\"text-xl font-bold\">Logic Configuration</h2></div>\n            <div class=\"p-6 space-y-8 max-h-[65vh] overflow-y-auto\" id=\"settings-form\">\n                <div class=\"space-y-6\">\n                    <section><h3 class=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3\">Core Billing</h3><div class=\"grid grid-cols-2 gap-4\" id=\"section-billing\"></div></section>\n                    <section><h3 class=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3\">Standard Factors</h3><div class=\"grid grid-cols-2 gap-4\" id=\"section-standard\"></div></section>\n                    <section><h3 class=\"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3\">Autonomous Factors</h3><div class=\"grid grid-cols-2 gap-4\" id=\"section-autonomous\"></div></section>\n                </div>\n            </div>\n            <div class=\"p-6 border-t bg-slate-50 flex gap-3\">\n                <button onclick=\"resetDefaults()\" class=\"py-3 px-4 rounded-xl font-semibold text-red-600 hover:bg-red-100 transition-colors\">Reset Defaults</button>\n                <div class=\"flex-1 flex gap-3\">\n                    <button onclick=\"toggleSettings(false)\" class=\"flex-1 py-3 rounded-xl font-semibold text-slate-600 hover:bg-slate-200\">Cancel</button>\n                    <button onclick=\"saveSettings()\" class=\"flex-1 py-3 rounded-xl font-semibold bg-sky-600 text-white hover:bg-sky-700 shadow-md\">Apply & Persist</button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        // Security logic\n        document.addEventListener('contextmenu', e => e.preventDefault());\n        document.addEventListener('keydown', e => {\n            if (e.ctrlKey && ['s','u'].includes(e.key.toLowerCase())) {\n                e.preventDefault();\n            }\n        });\n\n        const DEFAULT_RATES = {\n            days_per_month: 22, price_per_msg: 0.01,\n            graph: 10, genai: 2, actions: 5, \n            triggers: 7, deep: 10, flow: 0.13\n        };\n\n        const LABELS = {\n            days_per_month: \"Business Days / Month\", price_per_msg: \"Credit Unit Price ($)\",\n            graph: \"Standard Graph Burn\", genai: \"Standard GenAI Burn\",\n            actions: \"Standard Action Burn\", triggers: \"Auto Trigger Burn\",\n            deep: \"Reasoning Step Burn (o1)\", flow: \"Auto Flow Action Burn\"\n        };\n\n        let currentMode = 'standard';\n        const stored = JSON.parse(localStorage.getItem('copilot_rates_v4')) || {};\n        let RATES = { ...DEFAULT_RATES, ...stored };\n\n        function setMode(m) {\n            currentMode = m;\n            const stdBtn = document.getElementById('mode-std');\n            const autoBtn = document.getElementById('mode-auto');\n            const stdInputs = document.getElementById('standard-inputs');\n            const autoInputs = document.getElementById('autonomous-inputs');\n            const compTitle = document.getElementById('complexity-title');\n\n            if (stdBtn) stdBtn.classList.toggle('mode-active', m === 'standard');\n            if (autoBtn) autoBtn.classList.toggle('mode-active', m === 'autonomous');\n            if (stdInputs) stdInputs.classList.toggle('hidden', m === 'autonomous');\n            if (autoInputs) autoInputs.classList.toggle('hidden', m === 'standard');\n            if (compTitle) compTitle.innerText = `Session Profile (${m === 'standard' ? 'Standard' : 'Autonomous'})`;\n            calculate();\n        }\n\n        function syncInputs(id, val) {\n            const el = document.getElementById(id);\n            if (el) el.value = val;\n            calculate();\n        }\n\n        function populateRateTable() {\n            const table = document.getElementById('rate-table-body');\n            if (!table) return;\n            const data = [\n                { type: 'Tenant Graph Grounding', rate: RATES.graph, note: 'Knowledge Retrieval' },\n                { type: 'Generative Answers', rate: RATES.genai, note: 'Standard text output' },\n                { type: 'Autonomous Triggers', rate: RATES.triggers, note: 'Logic initiation' },\n                { type: 'Deep Reasoning (o1)', rate: RATES.deep, note: 'Complex orchestration' },\n                { type: 'Agent Flow Actions', rate: RATES.flow, note: 'Power Automate' },\n                { type: 'Credit Unit Price', rate: `$${RATES.price_per_msg}`, note: 'Per credit unit' }\n            ];\n            table.innerHTML = data.map(r => `\n                <tr class=\"border-b border-slate-50 hover:bg-slate-50/50 transition-colors\">\n                    <td class=\"p-4 font-medium text-slate-800\">${r.type}</td>\n                    <td class=\"p-4 text-center font-bold text-sky-600\">${r.rate}</td>\n                    <td class=\"p-4 text-slate-500 italic text-xs\">${r.note}</td>\n                </tr>\n            `).join('');\n        }\n\n        function calculate() {\n            const agentsEl = document.getElementById('num_agents');\n            const convosEl = document.getElementById('num_convos');\n            const agents = agentsEl ? parseFloat(agentsEl.value) : 0;\n            const convos = convosEl ? parseFloat(convosEl.value) : 0;\n            \n            let dailyTotalPerAgent = 0;\n            let breakdownHtml = '';\n\n            if (currentMode === 'standard') {\n                const gInput = document.getElementById('num_graph');\n                const aInput = document.getElementById('num_genai');\n                const g = gInput ? parseFloat(gInput.value) : 0;\n                const a = aInput ? parseFloat(aInput.value) : 0;\n                const gBurn = g * RATES.graph * convos;\n                const aBurn = a * RATES.genai * convos;\n                dailyTotalPerAgent = gBurn + aBurn;\n                breakdownHtml = `\n                    <div class=\"flex justify-between\"><span>Graph Grounding Daily</span><span class=\"font-bold\">${Math.round(gBurn).toLocaleString()}</span></div>\n                    <div class=\"flex justify-between\"><span>Gen Answers Daily</span><span class=\"font-bold\">${Math.round(aBurn).toLocaleString()}</span></div>\n                `;\n            } else {\n                const tInput = document.getElementById('num_triggers');\n                const dInput = document.getElementById('num_deep');\n                const gInput = document.getElementById('num_auto_genai');\n                const fInput = document.getElementById('num_flow');\n                const t = tInput ? parseFloat(tInput.value) : 0;\n                const d = dInput ? parseFloat(dInput.value) : 0;\n                const g = gInput ? parseFloat(gInput.value) : 0;\n                const f = fInput ? parseFloat(fInput.value) : 0;\n\n                const tBurn = t * RATES.triggers * convos;\n                const dBurn = d * RATES.deep * convos;\n                const gBurn = g * RATES.genai * convos;\n                const fBurn = f * RATES.flow * convos;\n                dailyTotalPerAgent = tBurn + dBurn + gBurn + fBurn;\n                breakdownHtml = `\n                    <div class=\"flex justify-between\"><span>Auto Triggers Daily</span><span class=\"font-bold\">${Math.round(tBurn).toLocaleString()}</span></div>\n                    <div class=\"flex justify-between\"><span>Deep Reasoning Daily</span><span class=\"font-bold\">${Math.round(dBurn).toLocaleString()}</span></div>\n                    <div class=\"flex justify-between\"><span>Gen Answers Daily</span><span class=\"font-bold\">${Math.round(gBurn).toLocaleString()}</span></div>\n                    <div class=\"flex justify-between\"><span>Flow Actions Daily</span><span class=\"font-bold\">${fBurn.toFixed(1)}</span></div>\n                `;\n            }\n\n            breakdownHtml += `<div class=\"flex justify-between border-t border-slate-100 pt-2 font-bold text-sky-600 uppercase tracking-tighter\"><span>Total Credits Daily / Agent</span><span>${Math.round(dailyTotalPerAgent).toLocaleString()}</span></div>`;\n            \n            const breakdownContainer = document.getElementById('breakdown-container');\n            if (breakdownContainer) breakdownContainer.innerHTML = breakdownHtml;\n\n            const fleetDaily = dailyTotalPerAgent * agents;\n            const monthlyCost = fleetDaily * RATES.days_per_month * RATES.price_per_msg;\n            const annualCost = monthlyCost * 12;\n\n            const totalAnnualEl = document.getElementById('total_annual');\n            const agentMonthlyEl = document.getElementById('agent_cost_monthly');\n            const totalDailyMsgsEl = document.getElementById('total_msgs_daily');\n            const summaryTextEl = document.getElementById('summary_text');\n\n            if (totalAnnualEl) totalAnnualEl.innerText = formatCurrency(annualCost);\n            if (agentMonthlyEl) agentMonthlyEl.innerText = agents > 0 ? formatCurrency(monthlyCost / agents) : \"$0.00\";\n            if (totalDailyMsgsEl) totalDailyMsgsEl.innerText = Math.round(fleetDaily).toLocaleString();\n            if (summaryTextEl) summaryTextEl.innerText = `Deployment of ${agents} ${currentMode} agents processing ${Math.round(fleetDaily).toLocaleString()} credits daily. Total monthly requirement is estimated at ${Math.round(fleetDaily * RATES.days_per_month).toLocaleString()} credits for the tenant pool.`;\n            \n            window.lastCalc = { \n                agents, annualCost, monthlyCost, fleetDaily, \n                mode: currentMode, burnPerConvo: dailyTotalPerAgent / convos || 0,\n                breakdownHtml, convos\n            };\n        }\n\n        function downloadPDF() {\n            const c = window.lastCalc;\n            const pdfDateEl = document.getElementById('pdf-date');\n            const pdfModeEl = document.getElementById('pdf-mode');\n            const pdfAgentsEl = document.getElementById('pdf-agents');\n            const pdfConvosEl = document.getElementById('pdf-convos');\n            const pdfAnnualEl = document.getElementById('pdf-annual');\n            const pdfMonthlyEl = document.getElementById('pdf-monthly');\n            const pdfBreakdownEl = document.getElementById('pdf-breakdown');\n\n            if (pdfDateEl) pdfDateEl.innerText = new Date().toLocaleDateString();\n            if (pdfModeEl) pdfModeEl.innerText = c.mode.toUpperCase();\n            if (pdfAgentsEl) pdfAgentsEl.innerText = c.agents;\n            if (pdfConvosEl) pdfConvosEl.innerText = c.convos;\n            if (pdfAnnualEl) pdfAnnualEl.innerText = formatCurrency(c.annualCost);\n            if (pdfMonthlyEl) pdfMonthlyEl.innerText = formatCurrency(c.monthlyCost);\n            if (pdfBreakdownEl) pdfBreakdownEl.innerText = \"\"; // Clear if previously text\n            if (pdfBreakdownEl) pdfBreakdownEl.innerHTML = c.breakdownHtml;\n\n            const element = document.getElementById('pdf-content');\n            if (!element) return;\n            const opt = {\n                margin: 0,\n                filename: `Copilot_Estimate_${c.agents}_Agents.pdf`,\n                image: { type: 'jpeg', quality: 0.98 },\n                html2canvas: { scale: 2 },\n                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }\n            };\n            html2pdf().set(opt).from(element).save();\n        }\n\n        function generateEmail() {\n            const c = window.lastCalc;\n            const subject = encodeURIComponent(`Funding Estimate: Copilot Studio Deployment (${c.agents} Agents)`);\n            const disclaimer = `Please note: This is an estimated value for funding and planning purposes only. Please attach the formal PDF Report for the full configuration breakdown. Baseline assumes a ${RATES.days_per_month}-day business month.`;\n            const spacer = \"\\n\".repeat(40);\n            const techAudit = `[INTERNAL AUDIT: v1.3.4.1 | CONFIG: ${c.mode.toUpperCase()} | INTENSITY: ${c.burnPerConvo.toFixed(2)} | PRICE: ${RATES.price_per_msg} | CYCLE: ${RATES.days_per_month}]`;\n\n            const body = encodeURIComponent(\n                `Hi,\\n\\nI have prepared the budgetary funding estimates for our proposed Copilot Studio deployment. Please find the high-level summary below and attach the formal PDF report to this message:\\n\\n` +\n                `Financial Projections:\\n` +\n                `-----------------------------------\\n` +\n                `• Number of Proposed Agents: ${c.agents}\\n` +\n                `• Estimated Annual Funding: ${formatCurrency(c.annualCost)}\\n` +\n                `• Estimated Monthly Operational Cost: ${formatCurrency(c.monthlyCost)}\\n` +\n                `• Projected Daily Credit Throughput: ${Math.round(c.fleetDaily).toLocaleString()}\\n\\n` +\n                `${disclaimer}\\n\\n` +\n                `Best regards,` +\n                `${spacer}\\n` +\n                `${techAudit}`\n            );\n            window.location.href = `mailto:?subject=${subject}&body=${body}`;\n        }\n\n        function formatCurrency(n) { return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(n); }\n\n        function toggleSettings(s) {\n            const m = document.getElementById('settings-modal');\n            const form = document.getElementById('settings-form');\n            if (s && form) {\n                const createInput = (k) => `\n                    <div class=\"flex flex-col p-2 bg-slate-50 border border-slate-100 rounded-lg\">\n                        <label class=\"text-[9px] font-bold uppercase text-slate-400 mb-1\">${LABELS[k]}</label>\n                        <input id=\"s_${k}\" type=\"number\" step=\"0.001\" value=\"${RATES[k]}\" class=\"w-full bg-transparent font-bold text-sky-700 outline-none text-sm\">\n                    </div>\n                `;\n                const billingSect = document.getElementById('section-billing');\n                const standardSect = document.getElementById('section-standard');\n                const autoSect = document.getElementById('section-autonomous');\n\n                if (billingSect) billingSect.innerHTML = ['days_per_month', 'price_per_msg'].map(createInput).join('');\n                if (standardSect) standardSect.innerHTML = ['graph', 'genai', 'actions'].map(createInput).join('');\n                if (autoSect) autoSect.innerHTML = ['triggers', 'deep', 'flow'].map(createInput).join('');\n                m.classList.remove('hidden');\n            } else if (m) {\n                m.classList.add('hidden');\n            }\n        }\n\n        function saveSettings() {\n            Object.keys(RATES).forEach(k => {\n                const el = document.getElementById(`s_${k}`);\n                if (el) RATES[k] = parseFloat(el.value);\n            });\n            localStorage.setItem('copilot_rates_v4', JSON.stringify(RATES));\n            toggleSettings(false);\n            populateRateTable();\n            calculate();\n        }\n\n        function resetDefaults() {\n            RATES = { ...DEFAULT_RATES };\n            localStorage.removeItem('copilot_rates_v4');\n            toggleSettings(false);\n            populateRateTable();\n            calculate();\n        }\n\n        function switchTab(t) {\n            const calcTab = document.getElementById('tab-calc');\n            const pricingTab = document.getElementById('tab-pricing');\n            const calcContent = document.getElementById('content-calculator');\n            const pricingContent = document.getElementById('content-pricing');\n\n            if (calcTab) calcTab.classList.toggle('tab-active', t==='calculator');\n            if (pricingTab) pricingTab.classList.toggle('tab-active', t==='pricing');\n            if (calcContent) calcContent.classList.toggle('hidden', t==='pricing');\n            if (pricingContent) pricingContent.classList.toggle('hidden', t==='calculator');\n            if(t==='pricing') populateRateTable();\n        }\n\n        populateRateTable();\n        calculate();\n    </script>\n</body>\n</html>"
}